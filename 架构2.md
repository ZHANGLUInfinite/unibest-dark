### 项目架构评估与优化建议

#### 一、仓库合并与整体架构
建议将 `create-unibest` 和 `unibest` 合并为单一monorepo仓库，采用以下结构：
```
packages/
  cli/              # 命令行交互 (create-unibest)
  generator/        # 项目生成引擎
  shared/           # 共享工具函数
  templates/        # 模板资源
    base/           # 基础框架模板
    ui/             # UI库模板
      sard-ui/
      wot-ui/
      uv-ui/
      uview-plus/
    features/       # 功能模块
      i18n/
      token/
```

#### 二、UI库拆分方案评估
**现状**：当前通过分支区分不同UI库，维护成本高
**建议方案**：采用「基础模板+UI插件」模式

1. **合理性分析**：
   - ✅ 优点：仅需维护差异化文件（主要是layouts），避免分支管理混乱
   - ❌ 缺点：需实现模板合并逻辑，增加generator复杂度

2. **具体实现**：
   ```
   templates/
     base/src/layouts/__placeholder__.vue  # 占位文件
     ui/sard-ui/src/layouts/index.vue      # 具体实现
     ui/wot-ui/src/layouts/index.vue       # 具体实现
   ```

#### 三、多维度选择实现
1. **交互式询问流程**（cli/src/prompts.ts）：
   ```typescript
   // 平台选择 → 动态过滤UI库 → 功能模块选择
   const platforms = await selectPlatforms()
   const uiLibraries = filterUILibrariesByPlatform(platforms)
   const features = await selectFeatures()
   ```

2. **模板合并策略**（generator/src/template.ts）：
   ```typescript
   // 1. 复制base模板
   // 2. 根据选择的UI库覆盖对应文件
   // 3. 根据选择的功能模块追加文件
   copyTemplate('base', targetDir)
   overwriteTemplate(`ui/${selectedUI}`, targetDir)
   appendTemplates(features, targetDir)
   ```

#### 四、当前模板目录重构步骤
1. **创建UI子包**：
   ```bash
   mkdir -p packages/templates/ui/{sard-ui,wot-ui,uv-ui,uview-plus}/src/layouts
   ```

2. **迁移差异化文件**：
   ```bash
   # 将各分支的layouts文件迁移到对应UI子包
   mv packages/templates/base/src/layouts/fg-tabbar packages/templates/ui/sard-ui/src/layouts/
   ```

3. **实现功能模块**：
   ```bash
   mkdir -p packages/templates/features/i18n/src/{lang,components}
   ```

#### 五、generator核心逻辑实现
```typescript
// generator/src/index.ts
import { mergeTemplates } from './template'

export async function generateProject(options) {
  const { ui, features, platforms } = options
  await mergeTemplates({
    base: 'base',
    ui,
    features,
    targetDir: options.projectDir
  })
  // 处理平台配置
  // 安装依赖
}
```

#### 六、关键注意事项
1. **版本管理**：所有子包使用统一版本号，通过根目录`pnpm version`统一升级
2. **依赖共享**：公共依赖提升至根目录`package.json`的`peerDependencies`
3. **测试策略**：为每个UI库编写独立的E2E测试
4. **文档更新**：维护`架构-monorepo.md`，添加模板合并流程图

通过以上调整，可实现多维度选择的灵活配置，同时保持代码复用率和维护性。建议优先实现UI库的模板拆分，再逐步迁移功能模块。
